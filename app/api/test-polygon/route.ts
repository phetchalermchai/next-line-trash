import { NextRequest, NextResponse } from "next/server";
import * as turf from "@turf/turf";

export async function GET(req: NextRequest) {
    const polygon: [number, number][] = [[13.87073109992732, 100.477352142334], [13.87171019934711, 100.4768264293671], [13.87434541449277, 100.4770410060883], [13.87786593188687, 100.4787576198578], [13.88126140986678, 100.4818153381348], [13.88610456694329, 100.4869973659516], [13.88982279305613, 100.4894328117371], [13.89299938154703, 100.4908382892609], [13.89411378095872, 100.4911708831787], [13.89439498370144, 100.4918253421783], [13.89447569924047, 100.492844581604], [13.89455901847704, 100.4941910505295], [13.89469441217255, 100.4959398508072], [13.89502248118344, 100.496798157692], [13.89517349692116, 100.4972541332245], [13.89519432667035, 100.4973882436752], [13.89488708767971, 100.4984718561173], [13.89464233768365, 100.4993623495102], [13.89458505573233, 100.4995769262314], [13.89418928913613, 100.5002582073212], [13.89411117722804, 100.5003869533539], [13.89426219355993, 100.500773191452], [13.89419449659575, 100.5010253190994], [13.8935539781861, 100.5016368627548], [13.89348628101493, 100.5019533634186], [13.89336650904821, 100.5022537708282], [13.89290825051686, 100.5024468898773], [13.89254372603774, 100.502918958664], [13.89252289605018, 100.5031818151474], [13.89255414103082, 100.5037987232208], [13.892517688553, 100.5039703845978], [13.8923406335791, 100.5043083429337], [13.89196048567802, 100.5046409368515], [13.89167927997991, 100.5048555135727], [13.89136682880391, 100.5050593614578], [13.89089294371606, 100.5067813396454], [13.89023158598413, 100.5093079805374], [13.88999724617733, 100.5101609230042], [13.88990871774418, 100.5102896690369], [13.88238107345205, 100.5131220817566], [13.87743368188939, 100.5149030685425], [13.86910099438768, 100.5179071426392], [13.86022635317742, 100.5212116241455], [13.85935137017911, 100.5212545394898], [13.86105966725348, 100.5082511901855], [13.86251795969039, 100.5023717880249], [13.86672612365173, 100.4929733276367], [13.86980928446353, 100.4870939254761], [13.87068422804294, 100.4850769042969], [13.87073109992732, 100.477352142334]];
    let coords = polygon;
    if (
        coords[0][0] !== coords[coords.length - 1][0] ||
        coords[0][1] !== coords[coords.length - 1][1]
    ) {
        coords = [...coords, coords[0]];
    }

    const pointLat = 13.886911749950814;
    const pointLng = 100.49623489379884;
    const pt = turf.point([pointLng, pointLat]);
    const turfPoly = turf.polygon([coords.map(([lat, lng]) => [lng, lat])]);
    const result = turf.booleanPointInPolygon(pt, turfPoly);

    return NextResponse.json({ inside: result });
}
